 <!doctype html>
 <html>
   <head>
     <title>Isaac Flath</title>
     <meta charset="utf-8">
     <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
<script src="https://unpkg.com/htmx.org@2.0.4/dist/htmx.min.js"></script><script src="https://cdn.jsdelivr.net/gh/answerdotai/fasthtml-js@1.0.12/fasthtml.js"></script><script src="https://cdn.jsdelivr.net/gh/answerdotai/surreal@main/surreal.js"></script><script src="https://cdn.jsdelivr.net/gh/gnat/css-scope-inline@main/script.js"></script><script src="https://unpkg.com/@tailwindcss/browser@4"></script>     <link rel="icon" type="image/x-icon" href="/static/favicon.ico">
   </head>
   <body>
     <div>
<script>
    document.addEventListener('DOMContentLoaded', function() {
      const menuToggle = document.getElementById('menu-toggle');
      const mobileMenu = document.getElementById('mobile-menu');
      
      if (menuToggle && mobileMenu) {
        // Set initial state explicitly
        mobileMenu.style.display = 'none';
        
        // Handle click events
        menuToggle.addEventListener('click', function(e) {
          e.preventDefault();
          e.stopPropagation();
          
          console.log('Menu toggle clicked');
          
          // Toggle menu visibility
          if (mobileMenu.style.display === 'block') {
            console.log('Hiding menu');
            mobileMenu.style.display = 'none';
            menuToggle.classList.remove('is-active');
            menuToggle.setAttribute('aria-expanded', 'false');
          } else {
            console.log('Showing menu');
            mobileMenu.style.display = 'block';
            menuToggle.classList.add('is-active');
            menuToggle.setAttribute('aria-expanded', 'true');
          }
        });
        
        // Close menu when clicking outside
        document.addEventListener('click', function(e) {
          if (!mobileMenu.contains(e.target) && !menuToggle.contains(e.target) && mobileMenu.style.display === 'block') {
            mobileMenu.style.display = 'none';
            menuToggle.classList.remove('is-active');
            menuToggle.setAttribute('aria-expanded', 'false');
          }
        });
      } else {
        console.error('Menu elements not found:', { menuToggle, mobileMenu });
      }
    });
    </script>       <style>
    /* Hamburger icon animation */
    .is-active .hamburger-line:nth-child(1) {
      transform: translateY(8px) rotate(45deg);
    }
    
    .is-active .hamburger-line:nth-child(2) {
      opacity: 0;
    }
    
    .is-active .hamburger-line:nth-child(3) {
      transform: translateY(-8px) rotate(-45deg);
    }
    
    #mobile-menu {
      display: none;
      z-index: 9999 !important;
      visibility: visible !important;
      opacity: 1 !important;
      background-color: white !important;
      position: absolute !important;
      top: 100% !important;
      left: 0 !important;
      width: 100% !important;
    }
    </style>
       <div class="bg-white/80 backdrop-blur supports-[backdrop-filter]:bg-white/60 top-0 z-50 border-b border-indigo-100 shadow-[0_2px_10px_rgba(165,180,252,0.15)] relative">
         <div class="mx-auto max-w-6xl px-4 sm:px-6 lg:px-8 py-4 flex justify-between items-center relative z-40">
<a href="/" class="text-3xl font-bold bg-gradient-to-r from-cyan-400 via-purple-400 to-yellow-400 text-transparent bg-clip-text hover:scale-105 transform transition-all duration-300 hover:drop-shadow-[0_0_8px_rgba(165,180,252,0.5)]">Isaac Flath</a>           <div class="hidden md:flex items-center gap-x-8">
<a href="/" class="relative px-4 py-2 text-cyan-600 hover:text-cyan-800 transition-all duration-300 hover:scale-110 after:content-[''] after:absolute after:bottom-0 after:left-0 after:w-full after:h-0.5 after:bg-gradient-to-r after:from-cyan-400 after:to-purple-400 after:scale-x-0 hover:after:scale-x-100 after:transition-transform after:duration-300">About</a><a href="/blog" class="relative px-4 py-2 text-yellow-600 hover:text-yellow-800 transition-all duration-300 hover:scale-110 after:content-[''] after:absolute after:bottom-0 after:left-0 after:w-full after:h-0.5 after:bg-gradient-to-r after:from-yellow-400 after:to-cyan-400 after:scale-x-0 hover:after:scale-x-100 after:transition-transform after:duration-300">Blog</a><a href="/feed" class="relative px-4 py-2 text-orange-600 hover:text-orange-800 transition-all duration-300 hover:scale-110 after:content-[''] after:absolute after:bottom-0 after:left-0 after:w-full after:h-0.5 after:bg-gradient-to-r after:from-orange-400 after:to-red-400 after:scale-x-0 hover:after:scale-x-100 after:transition-transform after:duration-300">RSS</a><form enctype="multipart/form-data" action="https://app.kit.com/forms/7782268/subscriptions" method="post" data-sv-form="7782268" data-uid="33bc264078" data-format="inline" data-version="5" class="seva-form formkit-form">               <div class="flex ml-8">
                 <input type="email" name="email_address" placeholder="Enter email" required class="w-48 px-3 py-2 rounded-l-lg border border-r-0 border-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-400 focus:border-transparent">
<button type="submit" class="px-4 py-2 bg-indigo-600 text-white rounded-r-lg hover:bg-indigo-700 transition-colors duration-200">Subscribe</button>               </div>
</form>           </div>
<button aria-expanded="false" aria-label="Toggle menu" type="button" id="menu-toggle" class="md:hidden p-3 rounded-lg hover:bg-indigo-50 focus:outline-none focus:ring-2 focus:ring-indigo-400 transition-all duration-300" name="menu-toggle">             <div class="flex flex-col justify-center items-center">
               <div class="w-6 h-0.5 bg-indigo-600 mb-1.5 transition-all duration-300 hamburger-line"></div>
               <div class="w-6 h-0.5 bg-indigo-600 mb-1.5 transition-all duration-300 hamburger-line"></div>
               <div class="w-6 h-0.5 bg-indigo-600 transition-all duration-300 hamburger-line"></div>
             </div>
</button>         </div>
         <div id="mobile-menu" class="md:hidden absolute top-full left-0 w-full bg-white border-b border-indigo-100 shadow-lg z-50 rounded-b-lg">
<a href="/" class="block w-full py-4 px-6 text-lg text-indigo-600 hover:text-indigo-800 hover:bg-indigo-50 transition-colors duration-300 border-b border-indigo-50">About</a><a href="/blog" class="block w-full py-4 px-6 text-lg text-yellow-600 hover:text-yellow-800 hover:bg-indigo-50 transition-colors duration-300 border-b border-indigo-50">Blog</a><a href="/feed" class="block w-full py-4 px-6 text-lg text-orange-600 hover:text-orange-800 hover:bg-indigo-50 transition-colors duration-300 border-b border-indigo-50">RSS</a>           <div class="p-6">
<form enctype="multipart/form-data" action="https://app.kit.com/forms/7782268/subscriptions" method="post" data-sv-form="7782268" data-uid="33bc264078" data-format="inline" data-version="5" class="seva-form formkit-form">               <div class="w-full">
                 <input type="email" name="email_address" placeholder="Enter email" required class="w-full px-4 py-2 mb-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-400">
<button type="submit" class="w-full px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors duration-200">Subscribe</button>               </div>
</form>           </div>
         </div>
       </div>
       <div>
         <div class="max-w-6xl mx-auto px-4 py-8">
           <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css">
           <link rel="stylesheet" href="/static/prism.css">
           <link rel="stylesheet" href="/static/blog_styles.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-javascript.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-bash.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-yaml.min.js"></script>           <div class="mb-8">
             <meta property="og:type" content="article">
             <meta property="og:url" content="https://isaacflath.com/blog/blog_post?fpath=posts%2F2020-12-30-TabularModeling.ipynb">
             <meta property="og:title" content="Tabular Modeling">
             <meta property="og:description" content="How to approach tabular modeling">
             <meta property="og:site_name" content="Isaac Flath's Blog">
             <meta name="twitter:card" content="summary_large_image">
             <meta name="twitter:title" content="Tabular Modeling">
             <meta name="twitter:description" content="How to approach tabular modeling">
             <meta property="article:published_time" content="2020-12-30">
             <meta property="article:author" content="Isaac Flath">
             <meta property="article:tag" content="Tabular Modeling">
             <link rel="canonical" href="https://isaacflath.com/blog/blog_post?fpath=posts%2F2020-12-30-TabularModeling.ipynb">
             <meta property="og:image" content="static/thumbnail_imgs/decisionTree.jpg">
             <meta name="twitter:image" content="static/thumbnail_imgs/decisionTree.jpg">
             <h1 class="gradient-text-primary text-4xl font-bold mb-4">Tabular Modeling</h1>
             <p class="text-xl text-gray-600 leading-relaxed">How to approach tabular modeling</p>
           </div>
           <div>
<script src="https://cdn.jsdelivr.net/gh/cferdinandi/gumshoe/dist/gumshoe.polyfills.min.js"></script><script>
        document.addEventListener('DOMContentLoaded', function() {
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const id = entry.target.id;
                        document.querySelectorAll('#toc-list a').forEach(link => {
                            const isActive = link.getAttribute('href') === '#' + id;
                            link.style.color = isActive ? '#4F46E5' : '#4B5563';
                            link.style.fontWeight = isActive ? '600' : '400';
                            link.style.borderLeftColor = isActive ? '#4F46E5' : 'transparent';
                        });
                    }
                });
            }, { threshold: 0.1 });

            // Observe all section headings
            document.querySelectorAll('span[id]').forEach(section => observer.observe(section));

            // Handle smooth scrolling
            document.querySelectorAll('#toc-list a').forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    document.querySelector(link.getAttribute('href')).scrollIntoView({
                        behavior: 'smooth'
                    });
                });
            });
        });
    </script>             <div class="lg:hidden mb-8">
               <div class="
            bg-gray-50 rounded-xl p-6
            border border-gray-200
            max-h-[calc(100vh-2rem)] overflow-y-auto
        ">
                 <h2 class="text-lg font-medium text-gray-900 mb-4">Contents</h2>
                 <div id="toc-list" class="space-y-1 border-l-2 border-gray-200">
<a href="#project-structure" class="
                          block text-sm text-gray-600 hover:text-indigo-600 
                          font-semibold
                          ml-0
                          py-2 border-l-2 pl-4
                          hover:border-indigo-500 border-transparent
                          transition-all duration-200
                      ">Project Structure</a><a href="#baseline-models" class="
                          block text-sm text-gray-600 hover:text-indigo-600 
                          font-semibold
                          ml-0
                          py-2 border-l-2 pl-4
                          hover:border-indigo-500 border-transparent
                          transition-all duration-200
                      ">Baseline Models</a><a href="#preliminary-eda" class="
                          block text-sm text-gray-600 hover:text-indigo-600 
                          font-semibold
                          ml-0
                          py-2 border-l-2 pl-4
                          hover:border-indigo-500 border-transparent
                          transition-all duration-200
                      ">Preliminary EDA</a><a href="#hierarchical-clustering" class="
                          block text-sm text-gray-600 hover:text-indigo-600 
                          font-normal
                          ml-4
                          py-2 border-l-2 pl-4
                          hover:border-indigo-500 border-transparent
                          transition-all duration-200
                      ">Hierarchical Clustering</a><a href="#standard-correlation-matrices" class="
                          block text-sm text-gray-600 hover:text-indigo-600 
                          font-normal
                          ml-4
                          py-2 border-l-2 pl-4
                          hover:border-indigo-500 border-transparent
                          transition-all duration-200
                      ">Standard Correlation Matrices</a><a href="#null-value-analysis" class="
                          block text-sm text-gray-600 hover:text-indigo-600 
                          font-normal
                          ml-4
                          py-2 border-l-2 pl-4
                          hover:border-indigo-500 border-transparent
                          transition-all duration-200
                      ">Null Value Analysis</a><a href="#understanding-hierarchies" class="
                          block text-sm text-gray-600 hover:text-indigo-600 
                          font-normal
                          ml-4
                          py-2 border-l-2 pl-4
                          hover:border-indigo-500 border-transparent
                          transition-all duration-200
                      ">Understanding Hierarchies</a><a href="#predictive-eda" class="
                          block text-sm text-gray-600 hover:text-indigo-600 
                          font-semibold
                          ml-0
                          py-2 border-l-2 pl-4
                          hover:border-indigo-500 border-transparent
                          transition-all duration-200
                      ">Predictive EDA</a><a href="#feature-importance" class="
                          block text-sm text-gray-600 hover:text-indigo-600 
                          font-normal
                          ml-4
                          py-2 border-l-2 pl-4
                          hover:border-indigo-500 border-transparent
                          transition-all duration-200
                      ">Feature Importance</a><a href="#time-consistency" class="
                          block text-sm text-gray-600 hover:text-indigo-600 
                          font-normal
                          ml-4
                          py-2 border-l-2 pl-4
                          hover:border-indigo-500 border-transparent
                          transition-all duration-200
                      ">Time Consistency</a><a href="#column-sort-order" class="
                          block text-sm text-gray-600 hover:text-indigo-600 
                          font-normal
                          ml-4
                          py-2 border-l-2 pl-4
                          hover:border-indigo-500 border-transparent
                          transition-all duration-200
                      ">Column sort order  </a><a href="#model-construction" class="
                          block text-sm text-gray-600 hover:text-indigo-600 
                          font-semibold
                          ml-0
                          py-2 border-l-2 pl-4
                          hover:border-indigo-500 border-transparent
                          transition-all duration-200
                      ">Model Construction</a><a href="#feature-engineering" class="
                          block text-sm text-gray-600 hover:text-indigo-600 
                          font-normal
                          ml-4
                          py-2 border-l-2 pl-4
                          hover:border-indigo-500 border-transparent
                          transition-all duration-200
                      ">Feature Engineering:  </a><a href="#model-architecture-random-forest-xgb-nn" class="
                          block text-sm text-gray-600 hover:text-indigo-600 
                          font-normal
                          ml-4
                          py-2 border-l-2 pl-4
                          hover:border-indigo-500 border-transparent
                          transition-all duration-200
                      ">Model Architecture:  Random Forest, XGB, NN</a><a href="#categorical-encoding" class="
                          block text-sm text-gray-600 hover:text-indigo-600 
                          font-normal
                          ml-4
                          py-2 border-l-2 pl-4
                          hover:border-indigo-500 border-transparent
                          transition-all duration-200
                      ">Categorical encoding</a><a href="#class-imbalance" class="
                          block text-sm text-gray-600 hover:text-indigo-600 
                          font-normal
                          ml-4
                          py-2 border-l-2 pl-4
                          hover:border-indigo-500 border-transparent
                          transition-all duration-200
                      ">Class imbalance</a><a href="#ensemble-approaches-try-a-few-ensemble-approaches" class="
                          block text-sm text-gray-600 hover:text-indigo-600 
                          font-normal
                          ml-4
                          py-2 border-l-2 pl-4
                          hover:border-indigo-500 border-transparent
                          transition-all duration-200
                      ">Ensemble Approaches:  Try a few ensemble approaches.</a><a href="#model-tuning" class="
                          block text-sm text-gray-600 hover:text-indigo-600 
                          font-normal
                          ml-4
                          py-2 border-l-2 pl-4
                          hover:border-indigo-500 border-transparent
                          transition-all duration-200
                      ">Model Tuning</a><a href="#model-eda" class="
                          block text-sm text-gray-600 hover:text-indigo-600 
                          font-semibold
                          ml-0
                          py-2 border-l-2 pl-4
                          hover:border-indigo-500 border-transparent
                          transition-all duration-200
                      ">Model EDA</a>                 </div>
               </div>
             </div>
             <div class="lg:flex lg:gap-8">
               <div class="lg:max-w-4xl">
                 <div class="prose-section my-4"><div><p class="text-lg leading-relaxed mb-6 text-gray-800"><strong>Background:</strong>  The most common type of data in most organizations is tabular data stored in a SQL database.  Tabular is also a great thing to model with because it's often already structured in a database and in a good format to start working with.  The uses for tabular data range from recommendation engines, to marketing action prediction, to churn prediction, predicting fraud, and much more.</p>
<p class="text-lg leading-relaxed mb-6 text-gray-800"><strong>Purpose:</strong> The purpose of this post is to walk through the things I think about for every tabular modeling problem.  I may not use every technique for every problem, and there are others that I may use on occasion - but these core ones should always be at least considered carefully (in my opinion)</p>
<p class="text-lg leading-relaxed mb-6 text-gray-800"><strong>Assumptions:</strong> In this guide I am assuming you have experience building tabular models in the past and are able to look up these techniques on your own.  This will offer brief descriptions of what things are and why they are important, but won't go into the level of depth needed in this post to implement these ideas.</p>
<p class="text-lg leading-relaxed mb-6 text-gray-800"><strong>What's missing from this post:</strong>  Modeling is only a small piece of the puzzle.  I am not covering how to define a problem, how to do ETL processes, how to deploy and productionalize things, how to communicate to the organization so it can be used, how to build processes around it so people can leverage your model, etc..  This is only covering the modeling portion.</p>
</div></div>
                 <div class="prose-section my-4"><div><h1 class="text-4xl font-bold mt-12 mb-6 gradient-text-primary"><span id="project-structure">Project Structure</span></h1>
<p class="text-lg leading-relaxed mb-6 text-gray-800">There are 5 main phases to a tabular modeling project.  Each serves it's own role.</p>
<ul class="space-y-3 mb-6 ml-6 text-lg text-gray-800 list-disc marker:text-indigo-400">
<li class="leading-relaxed pl-2"><strong>Baseline Models</strong></li>
<li class="leading-relaxed pl-2"><strong>Preliminary EDA</strong></li>
<li class="leading-relaxed pl-2"><strong>Predictive EDA</strong></li>
<li class="leading-relaxed pl-2"><strong>Model Construction</strong></li>
<li class="leading-relaxed pl-2"><strong>Mode Evaluation</strong></li>
</ul>
<p class="text-lg leading-relaxed mb-6 text-gray-800">The one thing that is common in <strong>EVERY</strong> phase is you should be constantly iterating.  Every time you learn something add it to your model and try it.  Experiment with the actual model.  A big mistake that people often make is building lots and lots of stuff and then trying to put it all together at the end.  You should be doing small micro adjustments to your model frequently and running experiments constantly.</p>
</div></div>
                 <div class="prose-section my-4"><div><h1 class="text-4xl font-bold mt-12 mb-6 gradient-text-primary"><span id="baseline-models">Baseline Models</span></h1>
<blockquote class="pl-6 border-l-4 border-gradient-to-b from-indigo-400 to-purple-400 
        italic mb-6 text-gray-700 py-2 bg-gradient-to-r from-purple-50 to-transparent">
<h4 class="text-xl font-semibold mt-6 mb-3 text-purple-700">Goals</h4>
<ul class="space-y-3 mb-6 ml-6 text-lg text-gray-800 list-disc marker:text-indigo-400">
<li class="leading-relaxed pl-2">Validate you've created and loaded the dataset properly.</li>
<li class="leading-relaxed pl-2">Verify that what you are predicting can be predicted and understand the difficulty of the problem.</li>
<li class="leading-relaxed pl-2">Verify there's no obvious data leakage in train vs valid</li>
</ul>
</blockquote>
<p class="text-lg leading-relaxed mb-6 text-gray-800">In this phase we are making baseline models.  The more complex the problem the more important this is.  Get an idea of the distribution of the labels.  What would your accuracy be if you predicted the dominant class all the time?  How good is just predicting the average value?  You can build these as formal models or if it's simple enough looking at the distribution.</p>
<p class="text-lg leading-relaxed mb-6 text-gray-800">From there we add a bit of complexity as we start to iterate.  You can move to a linear regression, logistic regression, random forest, or something else that is easy to train and set up.  Keep an eye on your metrics and look for things that are "too good to be true".  If you're getting a really high score in these early phases you should verify that you don't have a data leakage problem.  You do want to make sure you are doing better than just predicting the most common label.  If a simple model isn't better than that, a super advance complex model probably wont help either.</p>
<p class="text-lg leading-relaxed mb-6 text-gray-800">During this step you should also be verifying that you have created and loaded the dataset properly (including train/valid/test splits).  Do not just assume previous steps were done correctly.</p>
<p class="text-lg leading-relaxed mb-6 text-gray-800">You need to create your train and validation sets in this phase, which is crucial.  It's a good idea to use adversarial validation to check for data leakage between your train and valid sets as well.</p>
</div></div>
                 <div class="prose-section my-4"><div><h1 class="text-4xl font-bold mt-12 mb-6 gradient-text-primary"><span id="preliminary-eda">Preliminary EDA</span></h1>
<blockquote class="pl-6 border-l-4 border-gradient-to-b from-indigo-400 to-purple-400 
        italic mb-6 text-gray-700 py-2 bg-gradient-to-r from-purple-50 to-transparent">
<h4 class="text-xl font-semibold mt-6 mb-3 text-purple-700">Goal</h4>
<p class="text-lg leading-relaxed mb-6 text-gray-800">Identify a smaller set of columns to start working with.**</p>
</blockquote>
<p class="text-lg leading-relaxed mb-6 text-gray-800">The goal of this phase is to narrow the search.  Other than the obvious reasons of focusing time on higher value items, it also is important for determining feature importance later.</p>
<p class="text-lg leading-relaxed mb-6 text-gray-800">In the Preliminary EDA phase there's 4 main things I look at.</p>
<ol class="space-y-3 mb-6 ml-6 text-lg text-gray-800 list-decimal marker:text-indigo-400">
<li class="leading-relaxed pl-2">Hierarchical clustering</li>
<li class="leading-relaxed pl-2">Standard correlation matrices</li>
<li class="leading-relaxed pl-2">Null Value Analysis</li>
<li class="leading-relaxed pl-2">Understanding hierarchies</li>
</ol>
<h2 class="text-3xl font-bold mt-10 mb-5 gradient-text-secondary"><span id="hierarchical-clustering">Hierarchical Clustering</span></h2>
<p class="text-lg leading-relaxed mb-6 text-gray-800"><strong>Are any of these columns in the same sort order (regardless of scale or actual values)?</strong></p>
<pre class="bg-indigo-50 rounded-xl p-6 mb-6 shadow-inner overflow-x-auto border border-indigo-100"><code class="bg-indigo-50 px-2 py-0.5 rounded-md text-indigo-700 font-mono text-sm bg-transparent p-0 text-gray-800 font-mono text-sm block">    
</code></pre>
<p class="text-lg leading-relaxed mb-6 text-gray-800">Hierarchical clustering is underused and very valuable.  Tree based models (RF, XGboost, Catboost, etc) do not care about scale, just sort order.  A decision tree treats [1,2,3] the same as [1,20,300].  Because of that doing hierarchical clustering can help identify variables that are very similar for the purposes of modeling and is a powerful tool.  Instead of doing the clustering you could just do a spearman rank correlation matrix, which is the foundation for the hierarchical clustering.</p>
<h2 class="text-3xl font-bold mt-10 mb-5 gradient-text-secondary"><span id="standard-correlation-matrices">Standard Correlation Matrices</span></h2>
<p class="text-lg leading-relaxed mb-6 text-gray-800"><strong>Are any of these columns really highly correlated with other features and can be thrown out?</strong></p>
<p class="text-lg leading-relaxed mb-6 text-gray-800">Standard Correlation Matrices can be helpful as a secondary tool to identify similar columns</p>
<h2 class="text-3xl font-bold mt-10 mb-5 gradient-text-secondary"><span id="null-value-analysis">Null Value Analysis</span></h2>
<p class="text-lg leading-relaxed mb-6 text-gray-800"><strong>Are there patterns of null values where several columns are all always null as the same times?</strong></p>
<p class="text-lg leading-relaxed mb-6 text-gray-800">Analyzing where Null Values appear can be helpful in understanding how data was gathered or how processes effect the data.  There also may be groups of columns that are always null at the same time and you can avoid having null columns for each column and just have 1 for the set.</p>
<h2 class="text-3xl font-bold mt-10 mb-5 gradient-text-secondary"><span id="understanding-hierarchies">Understanding Hierarchies</span></h2>
<p class="text-lg leading-relaxed mb-6 text-gray-800">Giving careful thought to what a unique record is and understanding hierarchies is important?  Often there may be product hierarchies, or account hierarchies, or billing hierarchies to be aware of.</p>
</div></div>
                 <div class="prose-section my-4"><div><h1 class="text-4xl font-bold mt-12 mb-6 gradient-text-primary"><span id="predictive-eda">Predictive EDA</span></h1>
<blockquote class="pl-6 border-l-4 border-gradient-to-b from-indigo-400 to-purple-400 
        italic mb-6 text-gray-700 py-2 bg-gradient-to-r from-purple-50 to-transparent">
<h4 class="text-xl font-semibold mt-6 mb-3 text-purple-700">Goal</h4>
<p class="text-lg leading-relaxed mb-6 text-gray-800">Understand what features are most important and how they relate to the dependent variable.</p>
</blockquote>
<h2 class="text-3xl font-bold mt-10 mb-5 gradient-text-secondary"><span id="feature-importance">Feature Importance</span></h2>
<p class="text-lg leading-relaxed mb-6 text-gray-800"><strong>When building a model of remaining features, which features are most important?  Are there any that are not important?</strong></p>
<p class="text-lg leading-relaxed mb-6 text-gray-800">This is where we do our feature importance.  It's important to get rid of as many redundant features as possible before doing feature importance because having redundant features skews feature importance.  If there are 10 identical columns, then they each show as 1/10 the predictive power as any of the individual column.  You could easily filter then all out thinking none are important, when in reality you should have filtered 9 of them out.  The hierarchical Clustering in the previous section removes these redundancies.</p>
<p class="text-lg leading-relaxed mb-6 text-gray-800">Once you have the most important features you need to do a few things.  First, learn as much as you can about those columns.  How is data collected?  How is data updated?  Is there any data leakage?  What's the distribution?  What's the significance to the business?  The more you can learn about these important features the better.</p>
<p class="text-lg leading-relaxed mb-6 text-gray-800">If features are very unimportant you can cut them.  Simply choose an importance threshold, cut the features and measure performance of the model.  If the model still performs well then those features were not crucial.</p>
<pre class="bg-indigo-50 rounded-xl p-6 mb-6 shadow-inner overflow-x-auto border border-indigo-100"><code class="bg-indigo-50 px-2 py-0.5 rounded-md text-indigo-700 font-mono text-sm bg-transparent p-0 text-gray-800 font-mono text-sm block">
</code></pre>
<h2 class="text-3xl font-bold mt-10 mb-5 gradient-text-secondary"><span id="time-consistency">Time Consistency</span></h2>
<p class="text-lg leading-relaxed mb-6 text-gray-800"><strong>How consistent is the predictive power of a feature over time?</strong></p>
<pre class="bg-indigo-50 rounded-xl p-6 mb-6 shadow-inner overflow-x-auto border border-indigo-100"><code class="bg-indigo-50 px-2 py-0.5 rounded-md text-indigo-700 font-mono text-sm bg-transparent p-0 text-gray-800 font-mono text-sm block">
</code></pre>
<p class="text-lg leading-relaxed mb-6 text-gray-800">Measuring time consistency is an absolute necessity.  We are training on data to predict future data - and in production we will be predicting data even further in the future.  If features are unstable over time we need to be aware of that, and there's a good chance we can't use those features reliably.</p>
<p class="text-lg leading-relaxed mb-6 text-gray-800">To measure this you can build a 1 feature model to predict the dependent variable and see if predictive power remains constant over time for that feature.  You can then go to 2 feature models and do the same thing.  If features are extremely predictive for a few months and then not other months, your model will need some way to determine when to rely on that and when not to.  Sometimes it's in the months close to a contract start/end date but often it's just a feature we have to throw away.</p>
<h2 class="text-3xl font-bold mt-10 mb-5 gradient-text-secondary"><span id="column-sort-order">Column sort order  </span></h2>
<p class="text-lg leading-relaxed mb-6 text-gray-800"><strong>How does the order in which we evaluate columns matter?  If we have 2 highly correlated columns, does it matter which we choose to keep?</strong></p>
<pre class="bg-indigo-50 rounded-xl p-6 mb-6 shadow-inner overflow-x-auto border border-indigo-100"><code class="bg-indigo-50 px-2 py-0.5 rounded-md text-indigo-700 font-mono text-sm bg-transparent p-0 text-gray-800 font-mono text-sm block">
</code></pre>
<p class="text-lg leading-relaxed mb-6 text-gray-800">Earlier we threw away columns that were correlated to only keep 1.  In this step you can do tests to identify which should be thrown away.  If 2 columns are correlated and you threw 1 of them out, was that the right choice or should you have thrown the other out?</p>
<p class="text-lg leading-relaxed mb-6 text-gray-800">This often doesn't make a huge difference but it does sometimes so it is worth considering.</p>
</div></div>
                 <div class="prose-section my-4"><div><h1 class="text-4xl font-bold mt-12 mb-6 gradient-text-primary"><span id="model-construction">Model Construction</span></h1>
<blockquote class="pl-6 border-l-4 border-gradient-to-b from-indigo-400 to-purple-400 
        italic mb-6 text-gray-700 py-2 bg-gradient-to-r from-purple-50 to-transparent">
<h4 class="text-xl font-semibold mt-6 mb-3 text-purple-700">Goal</h4>
<p class="text-lg leading-relaxed mb-6 text-gray-800">Take our model and everything we have learned and put it together into a final model</p>
</blockquote>
<p class="text-lg leading-relaxed mb-6 text-gray-800">This is constructing the final model using everything we knew previously.  There are a lot of components.  I will touch on a few of the most critical ones.</p>
<h2 class="text-3xl font-bold mt-10 mb-5 gradient-text-secondary"><span id="feature-engineering">Feature Engineering:  </span></h2>
<p class="text-lg leading-relaxed mb-6 text-gray-800"><strong>How can we engineer and encode features to improve feature importance and/or time consistency?</strong></p>
<p class="text-lg leading-relaxed mb-6 text-gray-800">I wish there was great universal guidance here, but it's very domain specific.  Try an idea, measure validation performance keep if it helps.  Graph and visualize as much as you can and keep trying new ideas.</p>
<h2 class="text-3xl font-bold mt-10 mb-5 gradient-text-secondary"><span id="model-architecture-random-forest-xgb-nn">Model Architecture:  Random Forest, XGB, NN</span></h2>
<p class="text-lg leading-relaxed mb-6 text-gray-800">Considering architecture is important.  For most supervised tabular modeling you will want a Random Forest, XGBoost, or a Neural Network.  Random Forest is the simplest.  It is fairly accurate, fast to train and hard to screw up.  It's also the model with the more interpretability so if explainability is important this can be a good option.</p>
<p class="text-lg leading-relaxed mb-6 text-gray-800">XGboost often gives a performance boost, but it is more sensitive to hyperparameters and overfitting so it will take a bit longer to get it tuned properly.</p>
<p class="text-lg leading-relaxed mb-6 text-gray-800">A Neural Network is not usually the right answer for tabular data.  It might be worth trying if you have super high cardinality features, or really complex data you want to use alongside it (ie combining with text NLP model).</p>
<h2 class="text-3xl font-bold mt-10 mb-5 gradient-text-secondary"><span id="categorical-encoding">Categorical encoding</span></h2>
<p class="text-lg leading-relaxed mb-6 text-gray-800">The main ways to encode categorical variables are label, order, target encoding, count, and catboost.  I won't cover what each of them are, but try encoding things in different ways and see if it helps!</p>
<h2 class="text-3xl font-bold mt-10 mb-5 gradient-text-secondary"><span id="class-imbalance">Class imbalance</span></h2>
<p class="text-lg leading-relaxed mb-6 text-gray-800">Most problems in the real world I have run into have a class imbalance.  For example predicting customer churn there are way more customers staying than churning (hopefully).  Churn may account for 2% of the base.  There's several things that can be done to address this, the most common approaches are using a weighted loss or over/under sampling.</p>
<p class="text-lg leading-relaxed mb-6 text-gray-800">In Class imbalance problems it is also important that you have a good metric.  I am not discussing metrics here because the metric should have been defined before the dataset was even created.</p>
<h2 class="text-3xl font-bold mt-10 mb-5 gradient-text-secondary"><span id="ensemble-approaches-try-a-few-ensemble-approaches">Ensemble Approaches:  Try a few ensemble approaches.</span></h2>
<p class="text-lg leading-relaxed mb-6 text-gray-800">Ensembling is common, but not always necessary.  You can do cross-folding, but be aware it adds complexity at inference time.  Sometimes ensembling different architectures together can be valuable.</p>
<p class="text-lg leading-relaxed mb-6 text-gray-800">It really depends on the business use case and how much the increase in accuracy amounts to in real-world impact.</p>
<h2 class="text-3xl font-bold mt-10 mb-5 gradient-text-secondary"><span id="model-tuning">Model Tuning</span></h2>
<p class="text-lg leading-relaxed mb-6 text-gray-800">Model tuning can give improvements as well - most libraries have a built in tuning framework.  You will need to set hyperparameter ranges to try and run tests with different features.  There are many guides to fine tune a model - I will do a future post on how I approach tuning.  Sometimes a grid search is sufficient, but for XGBoosts I often use Bayesian Optimization with HYPEROPT.</p>
</div></div>
                 <div class="prose-section my-4"><div><h1 class="text-4xl font-bold mt-12 mb-6 gradient-text-primary"><span id="model-eda">Model EDA</span></h1>
<p class="text-lg leading-relaxed mb-6 text-gray-800">The goal of this phase is to build a model with what we found out in the first 2 and look to understand the model more deeply.  Hopefully this understanding can lead to us iterating and improving out model.  We may revisit any or all of previous steps as we explore.</p>
<p class="text-lg leading-relaxed mb-6 text-gray-800">This phase we do a lot of <a href="https://isaac-flath.github.io/fastblog/tabular/data%20exploration/2020/11/20/PartialDependencePlotting.html" class="text-indigo-600 hover:text-indigo-800 underline decoration-2 decoration-indigo-200 hover:decoration-indigo-500 transition-all duration-300">Partial Dependence Plotting</a>.  I won't cover the details here because they are covered in the linked post.</p>
<p class="text-lg leading-relaxed mb-6 text-gray-800">The second thing I use in this phase is the <code class="bg-indigo-50 px-2 py-0.5 rounded-md text-indigo-700 font-mono text-sm">treeinterpreter</code> and <code class="bg-indigo-50 px-2 py-0.5 rounded-md text-indigo-700 font-mono text-sm">waterfallcharts</code> libraries.  This allows me to look at individual or groups of predictions and see the contributions of different features.  For more information see <a href="https://github.com/fastai/fastbook/blob/master/09_tabular.ipynb" class="text-indigo-600 hover:text-indigo-800 underline decoration-2 decoration-indigo-200 hover:decoration-indigo-500 transition-all duration-300">Chapter 9 of the fastai book</a></p>
</div></div>
                 <div class="code-section my-6">
                 </div>
                 <div class="bg-gray-50 p-6 rounded-xl mt-12 border border-gray-200">
                   <h3 class="text-xl font-semibold mb-2 text-gray-900">Stay Updated</h3>
                   <p class="text-gray-600 mb-4">Get notified about new posts on AI, web development, and tech insights.</p>
<form enctype="multipart/form-data" action="https://app.convertkit.com/forms/7782268/subscriptions" method="post" data-sv-form="7782268" data-uid="33bc264078" data-format="inline" data-version="5" class="seva-form formkit-form">                     <div class="flex">
                       <input type="email" name="email_address" placeholder="Enter your email" required class="w-full md:w-64 px-4 py-2 rounded-l-lg border border-r-0 border-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-400 focus:border-transparent">
<button type="submit" class="px-6 py-2 bg-indigo-600 text-white rounded-r-lg hover:bg-indigo-700 transition-colors duration-200">Subscribe</button>                     </div>
</form>                 </div>
               </div>
               <div class="hidden lg:block lg:w-80 lg:flex-shrink-0 lg:ml-8 lg:sticky lg:top-4 lg:self-start">
                 <div class="
            bg-gray-50 rounded-xl p-6
            border border-gray-200
            max-h-[calc(100vh-2rem)] overflow-y-auto
        ">
                   <h2 class="text-lg font-medium text-gray-900 mb-4">Contents</h2>
                   <div id="toc-list" class="space-y-1 border-l-2 border-gray-200">
<a href="#project-structure" class="
                          block text-sm text-gray-600 hover:text-indigo-600 
                          font-semibold
                          ml-0
                          py-2 border-l-2 pl-4
                          hover:border-indigo-500 border-transparent
                          transition-all duration-200
                      ">Project Structure</a><a href="#baseline-models" class="
                          block text-sm text-gray-600 hover:text-indigo-600 
                          font-semibold
                          ml-0
                          py-2 border-l-2 pl-4
                          hover:border-indigo-500 border-transparent
                          transition-all duration-200
                      ">Baseline Models</a><a href="#preliminary-eda" class="
                          block text-sm text-gray-600 hover:text-indigo-600 
                          font-semibold
                          ml-0
                          py-2 border-l-2 pl-4
                          hover:border-indigo-500 border-transparent
                          transition-all duration-200
                      ">Preliminary EDA</a><a href="#hierarchical-clustering" class="
                          block text-sm text-gray-600 hover:text-indigo-600 
                          font-normal
                          ml-4
                          py-2 border-l-2 pl-4
                          hover:border-indigo-500 border-transparent
                          transition-all duration-200
                      ">Hierarchical Clustering</a><a href="#standard-correlation-matrices" class="
                          block text-sm text-gray-600 hover:text-indigo-600 
                          font-normal
                          ml-4
                          py-2 border-l-2 pl-4
                          hover:border-indigo-500 border-transparent
                          transition-all duration-200
                      ">Standard Correlation Matrices</a><a href="#null-value-analysis" class="
                          block text-sm text-gray-600 hover:text-indigo-600 
                          font-normal
                          ml-4
                          py-2 border-l-2 pl-4
                          hover:border-indigo-500 border-transparent
                          transition-all duration-200
                      ">Null Value Analysis</a><a href="#understanding-hierarchies" class="
                          block text-sm text-gray-600 hover:text-indigo-600 
                          font-normal
                          ml-4
                          py-2 border-l-2 pl-4
                          hover:border-indigo-500 border-transparent
                          transition-all duration-200
                      ">Understanding Hierarchies</a><a href="#predictive-eda" class="
                          block text-sm text-gray-600 hover:text-indigo-600 
                          font-semibold
                          ml-0
                          py-2 border-l-2 pl-4
                          hover:border-indigo-500 border-transparent
                          transition-all duration-200
                      ">Predictive EDA</a><a href="#feature-importance" class="
                          block text-sm text-gray-600 hover:text-indigo-600 
                          font-normal
                          ml-4
                          py-2 border-l-2 pl-4
                          hover:border-indigo-500 border-transparent
                          transition-all duration-200
                      ">Feature Importance</a><a href="#time-consistency" class="
                          block text-sm text-gray-600 hover:text-indigo-600 
                          font-normal
                          ml-4
                          py-2 border-l-2 pl-4
                          hover:border-indigo-500 border-transparent
                          transition-all duration-200
                      ">Time Consistency</a><a href="#column-sort-order" class="
                          block text-sm text-gray-600 hover:text-indigo-600 
                          font-normal
                          ml-4
                          py-2 border-l-2 pl-4
                          hover:border-indigo-500 border-transparent
                          transition-all duration-200
                      ">Column sort order  </a><a href="#model-construction" class="
                          block text-sm text-gray-600 hover:text-indigo-600 
                          font-semibold
                          ml-0
                          py-2 border-l-2 pl-4
                          hover:border-indigo-500 border-transparent
                          transition-all duration-200
                      ">Model Construction</a><a href="#feature-engineering" class="
                          block text-sm text-gray-600 hover:text-indigo-600 
                          font-normal
                          ml-4
                          py-2 border-l-2 pl-4
                          hover:border-indigo-500 border-transparent
                          transition-all duration-200
                      ">Feature Engineering:  </a><a href="#model-architecture-random-forest-xgb-nn" class="
                          block text-sm text-gray-600 hover:text-indigo-600 
                          font-normal
                          ml-4
                          py-2 border-l-2 pl-4
                          hover:border-indigo-500 border-transparent
                          transition-all duration-200
                      ">Model Architecture:  Random Forest, XGB, NN</a><a href="#categorical-encoding" class="
                          block text-sm text-gray-600 hover:text-indigo-600 
                          font-normal
                          ml-4
                          py-2 border-l-2 pl-4
                          hover:border-indigo-500 border-transparent
                          transition-all duration-200
                      ">Categorical encoding</a><a href="#class-imbalance" class="
                          block text-sm text-gray-600 hover:text-indigo-600 
                          font-normal
                          ml-4
                          py-2 border-l-2 pl-4
                          hover:border-indigo-500 border-transparent
                          transition-all duration-200
                      ">Class imbalance</a><a href="#ensemble-approaches-try-a-few-ensemble-approaches" class="
                          block text-sm text-gray-600 hover:text-indigo-600 
                          font-normal
                          ml-4
                          py-2 border-l-2 pl-4
                          hover:border-indigo-500 border-transparent
                          transition-all duration-200
                      ">Ensemble Approaches:  Try a few ensemble approaches.</a><a href="#model-tuning" class="
                          block text-sm text-gray-600 hover:text-indigo-600 
                          font-normal
                          ml-4
                          py-2 border-l-2 pl-4
                          hover:border-indigo-500 border-transparent
                          transition-all duration-200
                      ">Model Tuning</a><a href="#model-eda" class="
                          block text-sm text-gray-600 hover:text-indigo-600 
                          font-semibold
                          ml-0
                          py-2 border-l-2 pl-4
                          hover:border-indigo-500 border-transparent
                          transition-all duration-200
                      ">Model EDA</a>                   </div>
                 </div>
               </div>
             </div>
           </div>
<script>
            document.addEventListener('DOMContentLoaded', function() {
                // Highlight all code blocks
                Prism.highlightAll();
            });
        </script>         </div>
       </div>
       <section class="bg-gradient-to-b from-purple-50 to-indigo-50 mt-12">
         <div class="max-w-4xl mx-auto px-4">
           <div class="h-1 w-full bg-gradient-to-r from-indigo-300 via-purple-200 to-pink-200 mb-8 shadow-[0_0_15px_rgba(165,180,252,0.3)]"></div>
           <div class="space-y-4 py-8">
             <div class="flex justify-center">
               <h2 class="text-3xl font-bold text-center mb-6 bg-gradient-to-r from-indigo-400 to-purple-400 inline-block text-transparent bg-clip-text">Let&#x27;s Connect</h2>
             </div>
             <div class="flex gap-4 justify-center flex-wrap">
<a href="https://github.com/isaac-flath" class="px-6 py-3 rounded-lg bg-white/90 text-indigo-700 hover:bg-indigo-50 hover:scale-105 transform transition-all duration-300 hover:shadow-[0_0_15px_rgba(165,180,252,0.3)] border border-indigo-100">                 <div class="flex items-center">
<svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="w-6 h-6 text-indigo-400"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.237 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"></path></svg><span class="ml-2">GitHub</span>                 </div>
</a><a href="https://linkedin.com/in/isaacflath" class="px-6 py-3 rounded-lg bg-white/90 text-indigo-700 hover:bg-indigo-50 hover:scale-105 transform transition-all duration-300 hover:shadow-[0_0_15px_rgba(192,132,252,0.3)] border border-indigo-100">                 <div class="flex items-center">
<svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="w-6 h-6 text-purple-400"><path d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"></path></svg><span class="ml-2">LinkedIn</span>                 </div>
</a><a href="https://x.com/isaac_flath" class="px-6 py-3 rounded-lg bg-white/90 text-indigo-700 hover:bg-indigo-50 hover:scale-105 transform transition-all duration-300 hover:shadow-[0_0_15px_rgba(244,114,182,0.3)] border border-indigo-100">                 <div class="flex items-center">
<svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="w-6 h-6 text-pink-400"><path d="M23.953 4.57a10 10 0 01-2.825.775 4.958 4.958 0 002.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 00-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 00-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 01-2.228-.616v.06a4.923 4.923 0 003.946 4.827 4.996 4.996 0 01-2.212.085 4.936 4.936 0 004.604 3.417 9.867 9.867 0 01-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 007.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0024 4.59z"></path></svg><span class="ml-2">Twitter</span>                 </div>
</a>             </div>
             <p class="mt-8 text-sm text-indigo-600/70 text-center">© 2025 Isaac Flath • All rights reserved</p>
           </div>
         </div>
       </section>
     </div>
   </body>
 </html>
